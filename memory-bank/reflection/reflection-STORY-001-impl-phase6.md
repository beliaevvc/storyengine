# –†–µ—Ñ–ª–µ–∫—Å–∏—è: BUILD-07 Context Inspector

> **Task ID**: STORY-001
> **–§–∞–∑–∞**: Implementation Phase 6
> **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç**: Context Inspector (Right Panel)
> **–î–∞—Ç–∞**: 2026-01-17

---

## üìã –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

BUILD-07 —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª –ø—Ä–∞–≤—É—é –ø–∞–Ω–µ–ª—å Context Inspector ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—É—â–Ω–æ—Å—Ç—è—Ö (entities), –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã —Ç–µ–∫—É—â–µ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ.

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|------------|
| `ContextInspector` | –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–∞–Ω–µ–ª–∏ |
| `ActiveEntities` | –°–µ–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö entities |
| `EntityCard` | –ü–æ–ª–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ entity |
| `EntityAttributes` | Key-value –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ |
| `EntityRelationships` | –°–≤—è–∑–∏ –º–µ–∂–¥—É –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏ |
| `AIChatPlaceholder` | –ó–∞–≥–ª—É—à–∫–∞ AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ |

### –û–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–¥–∞

- `useEditorStore` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω `activeEntityIds` + actions –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

## ‚úÖ –ß—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å —Ö–æ—Ä–æ—à–æ

### 1. –ë—ã—Å—Ç—Ä–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –ø–ª–∞–Ω—É

- **–ö–æ–Ω—Ç–µ–∫—Å—Ç**: BUILD-07 –ø–ª–∞–Ω –±—ã–ª –¥–µ—Ç–∞–ª—å–Ω—ã–º –∏ —Å–æ–¥–µ—Ä–∂–∞–ª –≥–æ—Ç–æ–≤—ã–π –∫–æ–¥
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è –∑–∞–Ω—è–ª–∞ –º–∏–Ω–∏–º—É–º –≤—Ä–µ–º–µ–Ω–∏
- **–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å**: –î–µ—Ç–∞–ª—å–Ω—ã–µ –ø–ª–∞–Ω—ã —Å –∫–æ–¥–æ–º —É—Å–∫–æ—Ä—è—é—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –≤ 3-5 —Ä–∞–∑

### 2. –ß–∏—Å—Ç–∞—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **–ö–æ–Ω—Ç–µ–∫—Å—Ç**: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –º–µ–ª–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (EntityAttributes, EntityRelationships)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
- **–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å**: –ü–∞—Ç—Ç–µ—Ä–Ω "–æ–¥–∏–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç ‚Äî –æ–¥–Ω–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å"

### 3. –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–ö–æ–Ω—Ç–µ–∫—Å—Ç**: –°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è Entity, EntityType, attributes
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: TypeScript –∫–æ–º–ø–∏–ª—è—Ü–∏—è –±–µ–∑ –æ—à–∏–±–æ–∫ —Å –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞
- **–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ –∏–∑ `@/core/entities` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ stores

- **–ö–æ–Ω—Ç–µ–∫—Å—Ç**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ useUIStore, useEntityStore, useEditorStore
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ë–µ—Å—à–æ–≤–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –±–µ–∑ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- **–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å**: Zustand stores –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è—é—Ç—Å—è

---

## ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### 1. EMFILE: too many open files

| –ê—Å–ø–µ–∫—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|
| **–ü—Ä–æ–±–ª–µ–º–∞** | macOS –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª Next.js –∏–∑-–∑–∞ –ª–∏–º–∏—Ç–∞ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤ |
| **–°–∏–º–ø—Ç–æ–º** | 404 –Ω–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö, –æ—à–∏–±–∫–∏ Watchpack |
| **–ü—Ä–∏—á–∏–Ω–∞** | –°–∏—Å—Ç–µ–º–Ω—ã–π –ª–∏–º–∏—Ç `ulimit -n` –±—ã–ª —Å–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∏–º |
| **–†–µ—à–µ–Ω–∏–µ** | `ulimit -n 65536 && npm run dev` |
| **–£—Ä–æ–∫** | –î–æ–±–∞–≤–∏—Ç—å –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø—Ä–æ–µ–∫—Ç–∞ |

### 2. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–æ–∑–¥–∞–Ω—ã, –Ω–æ –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã

| –ê—Å–ø–µ–∫—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|
| **–ü—Ä–æ–±–ª–µ–º–∞** | –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –¥–µ–º–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–ª–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π |
| **–ü—Ä–∏—á–∏–Ω–∞** | –ù–æ–≤—ã–π `ContextInspector` –Ω–µ –±—ã–ª –ø–æ–¥–∫–ª—é—á—ë–Ω –≤ page.tsx |
| **–†–µ—à–µ–Ω–∏–µ** | –ó–∞–º–µ–Ω–∏–ª `InspectorPlaceholder` –Ω–∞ `ContextInspector` + –¥–æ–±–∞–≤–∏–ª demo entities |
| **–£—Ä–æ–∫** | –í—Å–µ–≥–¥–∞ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤ layout/page –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è |

### 3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ activeEntityIds –≤ store

| –ê—Å–ø–µ–∫—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|
| **–ü—Ä–æ–±–ª–µ–º–∞** | –ü–ª–∞–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `activeEntityIds`, –Ω–æ –µ–≥–æ –Ω–µ –±—ã–ª–æ –≤ store |
| **–ü—Ä–∏—á–∏–Ω–∞** | –ü—Ä–æ–ø—É—Å—Ç–∏–ª–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ useEditorStore –≤ BUILD-06 |
| **–†–µ—à–µ–Ω–∏–µ** | –î–æ–±–∞–≤–∏–ª–∏ –ø–æ–ª–µ –∏ actions –≤ useEditorStore |
| **–£—Ä–æ–∫** | –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –ø–ª–∞–Ω–∞–º–∏ –ø–µ—Ä–µ–¥ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–µ–π |

---

## üí° –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å–∞–π—Ç—ã

### Entity Type Colors —á–µ—Ä–µ–∑ Tailwind

```typescript
// –í–º–µ—Å—Ç–æ dynamic class generation
const entityBgColors: Record<EntityType, string> = {
  CHARACTER: 'bg-entity-character/20',
  LOCATION: 'bg-entity-location/20',
  // ...
};
```

**–ü–æ—á–µ–º—É**: Tailwind –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç dynamic classes. Mapping –æ–±—ä–µ–∫—Ç ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥.

### Conditional Rendering –¥–ª—è —Ç–∏–ø–æ–≤

```typescript
{entity.type === 'CHARACTER' && relationships && (
  <EntityRelationships relationships={relationships} />
)}
```

**–ü–æ—á–µ–º—É**: –ù–µ –≤—Å–µ —Ç–∏–ø—ã entities –∏–º–µ—é—Ç relationships. CHARACTER ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–∏–ø —Å —ç—Ç–∏–º –ø–æ–ª–µ–º.

### Type Casting –¥–ª—è Prisma JSON

```typescript
const attributes = (entity.attributes ?? {}) as Record<string, unknown>;
const relationships = attributes.relationships as Record<string, {...}> | undefined;
```

**–ü–æ—á–µ–º—É**: Prisma JSON fields –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `unknown`. –Ø–≤–Ω—ã–π casting –Ω–µ–æ–±—Ö–æ–¥–∏–º.

---

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å–Ω—ã–µ –∏–Ω—Å–∞–π—Ç—ã

### 1. Demo –¥–∞–Ω–Ω—ã–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

- –ù–µ–ª—å–∑—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å UI –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö –≤ stores
- –í—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è—Ç—å demo entities –ø—Ä–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π —à–∞–≥

- –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ ‚â† —Ä–∞–±–æ—á–∏–π UI
- –ß–µ–∫–ª–∏—Å—Ç: —Å–æ–∑–¥–∞—Ç—å ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–º–ø–∏–ª—è—Ü–∏—é ‚Üí –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ layout ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω–æ

### 3. –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã macOS

- EMFILE –æ—à–∏–±–∫–∏ ‚Äî —á–∞—Å—Ç–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –Ω–∞ macOS —Å –±–æ–ª—å—à–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏
- –î–æ–±–∞–≤–∏—Ç—å –≤ README: `ulimit -n 65536`

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —Ñ–∞–∑—ã

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| –§–∞–π–ª–æ–≤ —Å–æ–∑–¥–∞–Ω–æ | 7 |
| –§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ | 2 (useEditorStore.ts, page.tsx) |
| TypeScript –æ—à–∏–±–æ–∫ | 0 |
| ESLint –æ—à–∏–±–æ–∫ | 0 |
| Blocker issues | 1 (EMFILE) |

---

## üéØ –î–µ–π—Å—Ç–≤–∏—è –Ω–∞ –±—É–¥—É—â–µ–µ

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ

- [x] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å EMFILE workaround –≤ README

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ (BUILD-08/09)

- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–ª–∏–∫ –Ω–∞ entity –≤ Database tab ‚Üí –≤—ã–±–æ—Ä –≤ Inspector
- [ ] –ü–æ–¥–∫–ª—é—á–∏—Ç—å AI Scan –∫ activeEntityIds
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–∫ –Ω–∞ entity mark –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ

- [ ] –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ entity –ø—Ä—è–º–æ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ
- [ ] Drag & drop entity –≤ —Ç–µ–∫—Å—Ç
- [ ] Real-time AI suggestions

---

## üìù –û–±–Ω–æ–≤–ª–µ–Ω–∏—è Memory Bank

- [x] `tasks.md` ‚Äî –æ–±–Ω–æ–≤–ª—ë–Ω —Å—Ç–∞—Ç—É—Å BUILD-07
- [x] `activeContext.md` ‚Äî –æ–±–Ω–æ–≤–ª—ë–Ω current status
- [x] `progress.md` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω—ã –º–µ—Ç—Ä–∏–∫–∏ —Ñ–∞–∑—ã 6

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

```
‚úì System overview complete             [YES]
‚úì Key achievements documented          [YES]
‚úì Technical challenges documented      [YES]
‚úì Process insights extracted           [YES]
‚úì Action items defined                 [YES]
‚úì Memory Bank updated                  [YES]
```

---

## –ò—Ç–æ–≥

BUILD-07 —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à—ë–Ω. Context Inspector —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å–æ–≥–ª–∞—Å–Ω–æ –ø–ª–∞–Ω—É. –û—Å–Ω–æ–≤–Ω–æ–π blocker (EMFILE) –±—ã–ª —Å–∏—Å—Ç–µ–º–Ω–æ–π –ø—Ä–æ–±–ª–µ–º–æ–π macOS, –Ω–µ —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å –∫–æ–¥–æ–º. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≥–æ—Ç–æ–≤—ã –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å two-way binding –≤ BUILD-08/09.

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: `/archive` –¥–ª—è —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ —Ñ–∞–∑—ã.
